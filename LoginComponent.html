<script id="login-template" type="text/x-template">
  <div>
    <md-dialog 
      :md-active.sync="formOptions.showLogin" 
      :md-close-on-esc="false" 
      :md-click-outside-to-close="false"
    >
      <md-dialog-title>Please Log In</md-dialog-title>
      <md-dialog-content>
        <md-field>
          <label>Password</label>
          <md-input v-model="pw" type="password"></md-input>
        </md-field>
      </md-dialog-content>
      <md-dialog-actions>
        <md-button @click="attemptLogin">Login</md-button>
      </md-dialog-actions>
    </md-dialog>
  
    <md-snackbar 
      id="login-snackbar" 
      :md-duration="2000" 
      :md-active.sync="formOptions.showLoginError"
    >
      <span style="color:yellow">ಠ_ಠ</span>
      <span>Incorrect Password!</span>
    </md-snackbar>
  </div>
</script>

<script>
  (function(){
    Vue.component("login-dialog", {
      template: "#login-template",
      data: function() { return {
        pw: "",
        showLoginError: false,
      }},
      methods: {
        attemptLogin: function() {
          google.script.run
          .withSuccessHandler(function(data) {
            if(data !== "OK") return this.showLoginError = true;
            
            if (data === "OK")this.$emit("login-successful");   
          })
          .tryLogin( this.pw );
        },
      }
    });
  })();
  
</script>